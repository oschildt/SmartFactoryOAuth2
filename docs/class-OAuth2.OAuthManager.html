<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="stylesheet" href="resources/bootstrap.min.css">
        <link rel="stylesheet" href="resources/style.css">
        <link rel="stylesheet" href="resources/jquery.iviewer.css">

        <title>
            Class: OAuthManager
        </title>
    </head>

    <body>
        <div id="navigation">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <nav class="navbar">
                    <ul class="nav navbar-nav">
                        
                        
                        <li>
                            <a href="index.html" class="">
                                Overview
                            </a>
                        </li>
                        
                        <li>
                            <a href="classes.html" class="active">
                                Classes
                            </a>
                        </li>
                        
                        <li>
                            <a href="interfaces.html" class="">
                                Interfaces
                            </a>
                        </li>
                        
                        <li>
                            <a href="structure.html" class="">
                                Structure
                            </a>
                        </li>
                        

                    </ul>

                    <form id="search" class="pull-right">
                        <input type="text" name="q" class="form-control text" placeholder="Search class, function or namespace">
                    </form>
                </nav>
            </div>
        </div>
    </div>
</div>

        
        <div id="breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
            
                
                <div class="pull-left type">
                    <span class="label label-success">Class</span>
                </div>
                
                
                <ol class="breadcrumb pull-left">
                        
                        

                        <li>
                            <a href="namespace-OAuth2.html">OAuth2</a>
                        </li>

                        <!-- if separator -->
                        <li class="backslash">\</li>
                        <!-- endif separator -->

                        
 

                        <li class="active">OAuthManager</li>
                </ol>
                
            </div>
        </div>
    </div>
</div>

        
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h1>Class: OAuthManager</h1>



<div class="definition"></div>


<div class="short-description">
<p>Class for secure user authentication.</p>
</div>








<h2>Implements</h2>
<div class="item_list">

<a href='interface-OAuth2.Interfaces.IOAuthManager.html'>\OAuth2\Interfaces\IOAuthManager</a><br>

</div>





<h2>Authors</h2>
<div class="item_list">

<div class='item'>Oleg Schildt</div>

</div>








<h2>Source code</h2>
<div class="item_list">
<a href='source-OAuth2.OAuthManager.php.html#21'>OAuth2/OAuthManager.php</a>
</div>


















<p>&nbsp;</p>



<table class="table table-responsive table-bordered table-striped class_multicolumn">
      <tr><th colspan="2">Properties</th></tr>
      
      <tr>
          <td>
              <div style='float:left'><a href="#$access_token_ttl_minutes">$access_token_ttl_minutes</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal property for storing the time to live of the access token.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#$encryption_algorithm">$encryption_algorithm</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal property for storing the encryption algorithm.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#$pass_phrase">$pass_phrase</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal property for storing the pass phrase for the private key.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#$private_key">$private_key</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal property for storing the path to the provate key file.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#$public_key">$public_key</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal property for storing the path to the public key file.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#$refresh_token_ttl_days">$refresh_token_ttl_days</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal property for storing the time to live of the refresh token.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#$secret_key">$secret_key</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal property for storing the sekret key.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#$supported_algorithms">$supported_algorithms</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal property for the list of supported algorithms.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#$token_storage">$token_storage</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal reference to the token storage object.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#$user_authenticator">$user_authenticator</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal reference to the user authenticator object.</p>
          </td>
      </tr>
      
  </table>

<table class="table table-responsive table-bordered table-striped class_multicolumn">
      <tr><th colspan="2">Methods</th></tr>
      
      <tr>
          <td>
              <div style='float:left'><a href="#authenticateUser">authenticateUser()</a></div>

              <div style='float:right'>
              
              <span class='label label-success'>public</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Authenticates the user based on the specified credentials and writes the response.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#createJwtToken">createJwtToken()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for creation of the jwt token.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#createTokenRecord">createTokenRecord()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for creation of the token record.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#generateJwtSignature">generateJwtSignature()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for generation of the signature of the data for all supported algorithms.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#generateRSASignature">generateRSASignature()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for generation of the signature of the data for the algorithms
RS256, RS384, RS512.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#generateToken">generateToken()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for generation of a token string.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#getJwtPayload">getJwtPayload()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for extraction of the payload from the jwt access token.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#init">init()</a></div>

              <div style='float:right'>
              
              <span class='label label-success'>public</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Initializes the authentication manager with parameters.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#invalidateClient">invalidateClient()</a></div>

              <div style='float:right'>
              
              <span class='label label-success'>public</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Invalidates all token records for the client.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#invalidateJwtAccessToken">invalidateJwtAccessToken()</a></div>

              <div style='float:right'>
              
              <span class='label label-success'>public</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Invalidates the token record for the jwt access token.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#invalidateRefreshToken">invalidateRefreshToken()</a></div>

              <div style='float:right'>
              
              <span class='label label-success'>public</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Invalidates all token records for the refresh token.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#invalidateUser">invalidateUser()</a></div>

              <div style='float:right'>
              
              <span class='label label-success'>public</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Invalidates all token records for the user.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#refreshTokens">refreshTokens()</a></div>

              <div style='float:right'>
              
              <span class='label label-success'>public</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Refreshes the access and refresh tokens by using the valid refresh token.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#urlSafeB64Decode">urlSafeB64Decode()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for safe base64 decoding.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#urlSafeB64Encode">urlSafeB64Encode()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for safe base64 encoding.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#validateParameters">validateParameters()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for validation of the parameters.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#verifyJwtAccessToken">verifyJwtAccessToken()</a></div>

              <div style='float:right'>
              
              <span class='label label-success'>public</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Verifies the jwt access token.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#verifyJwtSignature">verifyJwtSignature()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for verification of the signature of the data for all supported algorithms.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#verifyRSASignature">verifyRSASignature()</a></div>

              <div style='float:right'>
              
              <span class='label label-warning'>protected</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Internal auxiliary function for verification of the data signature for the algorithms
RS256, RS384, RS512.</p>
          </td>
      </tr><tr>
          <td>
              <div style='float:left'><a href="#verifyRefreshToken">verifyRefreshToken()</a></div>

              <div style='float:right'>
              
              <span class='label label-success'>public</span>
              </div>
              <div style="clear:both"></div>
          </td>
          <td class="description_column">
              <p>Verifies the refresh token.</p>
          </td>
      </tr>
      
  </table>



<hr id="$access_token_ttl_minutes">
  
  <h1>Property: OAuthManager::$access_token_ttl_minutes</h1>

  <div class="definition"><span class="php-keyword1">protected</span> string <span class="php-var">$access_token_ttl_minutes</span> = <span class="php-keyword1">null</span>;</div>

  
  <div class="short-description">
  <p>Internal property for storing the time to live of the access token.</p>
  </div>
  

  

  
  <h2>Type</h2>
  <div class="item_list">
  string
  </div>
  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#74'>OAuth2/OAuthManager.php</a>
  </div><hr id="$encryption_algorithm">
  
  <h1>Property: OAuthManager::$encryption_algorithm</h1>

  <div class="definition"><span class="php-keyword1">protected</span> string <span class="php-var">$encryption_algorithm</span> = <span class="php-keyword1">null</span>;</div>

  
  <div class="short-description">
  <p>Internal property for storing the encryption algorithm.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>The supported algorithms are HS256, HS384, HS512, RS256, RS384, RS512.</p>
  </div>
  

  
  <h2>Type</h2>
  <div class="item_list">
  string
  </div>
  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#65'>OAuth2/OAuthManager.php</a>
  </div><hr id="$pass_phrase">
  
  <h1>Property: OAuthManager::$pass_phrase</h1>

  <div class="definition"><span class="php-keyword1">protected</span> string <span class="php-var">$pass_phrase</span> = <span class="php-quote">&quot;&quot;</span>;</div>

  
  <div class="short-description">
  <p>Internal property for storing the pass phrase for the private key.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>Only required, if the private key was generated with a pass phrase.</p>
  </div>
  

  
  <h2>Type</h2>
  <div class="item_list">
  string
  </div>
  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#116'>OAuth2/OAuthManager.php</a>
  </div><hr id="$private_key">
  
  <h1>Property: OAuthManager::$private_key</h1>

  <div class="definition"><span class="php-keyword1">protected</span> string <span class="php-var">$private_key</span> = <span class="php-keyword1">null</span>;</div>

  
  <div class="short-description">
  <p>Internal property for storing the path to the provate key file.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>Required for the algorithms: RS256, RS384, RS512.</p>
  </div>
  

  
  <h2>Type</h2>
  <div class="item_list">
  string
  </div>
  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#105'>OAuth2/OAuthManager.php</a>
  </div><hr id="$public_key">
  
  <h1>Property: OAuthManager::$public_key</h1>

  <div class="definition"><span class="php-keyword1">protected</span> string <span class="php-var">$public_key</span> = <span class="php-keyword1">null</span>;</div>

  
  <div class="short-description">
  <p>Internal property for storing the path to the public key file.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>Required for the algorithms: RS256, RS384, RS512.</p>
  </div>
  

  
  <h2>Type</h2>
  <div class="item_list">
  string
  </div>
  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#94'>OAuth2/OAuthManager.php</a>
  </div><hr id="$refresh_token_ttl_days">
  
  <h1>Property: OAuthManager::$refresh_token_ttl_days</h1>

  <div class="definition"><span class="php-keyword1">protected</span> string <span class="php-var">$refresh_token_ttl_days</span> = <span class="php-keyword1">null</span>;</div>

  
  <div class="short-description">
  <p>Internal property for storing the time to live of the refresh token.</p>
  </div>
  

  

  
  <h2>Type</h2>
  <div class="item_list">
  string
  </div>
  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#83'>OAuth2/OAuthManager.php</a>
  </div><hr id="$secret_key">
  
  <h1>Property: OAuthManager::$secret_key</h1>

  <div class="definition"><span class="php-keyword1">protected</span> string <span class="php-var">$secret_key</span> = <span class="php-keyword1">null</span>;</div>

  
  <div class="short-description">
  <p>Internal property for storing the sekret key.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>The secret key is required for the algoritms HS256, HS384, HS512.</p>
  </div>
  

  
  <h2>Type</h2>
  <div class="item_list">
  string
  </div>
  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#54'>OAuth2/OAuthManager.php</a>
  </div><hr id="$supported_algorithms">
  
  <h1>Property: OAuthManager::$supported_algorithms</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">array</span> <span class="php-var">$supported_algorithms</span> = [<span class="php-quote">'HS256'</span>, <span class="php-quote">'HS384'</span>, <span class="php-quote">'HS512'</span>, <span class="php-quote">'RS256'</span>, <span class="php-quote">'RS384'</span>, <span class="php-quote">'RS512'</span>];</div>

  
  <div class="short-description">
  <p>Internal property for the list of supported algorithms.</p>
  </div>
  

  

  
  <h2>Type</h2>
  <div class="item_list">
  array
  </div>
  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#125'>OAuth2/OAuthManager.php</a>
  </div><hr id="$token_storage">
  
  <h1>Property: OAuthManager::$token_storage</h1>

  <div class="definition"><span class="php-keyword1">protected</span> \OAuth2\Interfaces\ITokenStorage <span class="php-var">$token_storage</span> = <span class="php-keyword1">null</span>;</div>

  
  <div class="short-description">
  <p>Internal reference to the token storage object.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>It must implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</p>
  </div>
  

  
  <h2>Type</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>
  </div>
  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#32'>OAuth2/OAuthManager.php</a>
  </div><hr id="$user_authenticator">
  
  <h1>Property: OAuthManager::$user_authenticator</h1>

  <div class="definition"><span class="php-keyword1">protected</span> \OAuth2\Interfaces\IUserAuthenticator <span class="php-var">$user_authenticator</span> = <span class="php-keyword1">null</span>;</div>

  
  <div class="short-description">
  <p>Internal reference to the user authenticator object.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>It must implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</p>
  </div>
  

  
  <h2>Type</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>
  </div>
  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#43'>OAuth2/OAuthManager.php</a>
  </div>

<hr id="authenticateUser">
  
  <h1>Method: OAuthManager::authenticateUser()</h1>

  <div class="definition"><span class="php-keyword1">public</span> <span class="php-keyword1">function</span> authenticateUser(<span class="php-keyword1">array</span> <span class="php-var">$credentials</span>, <span class="php-keyword1">array</span> &amp;<span class="php-var">$response</span>) : void;</div>

  
  <div class="short-description">
  <p>Authenticates the user based on the specified credentials and writes the response.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $credentials
            </td>
            <td>
                by value
            </td>
            <td>
                array
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The credentials for the authentication. The expected credentials are:</p>
<ul>
<li>$credentials[&quot;client_id&quot;] - id of the client (device token etc.).</li>
<li>$credentials[&quot;user_login&quot;] - the user login.</li>
<li>$credentials[&quot;user_password&quot;] - the user password.</li>
<li>$credentials[&quot;user_password&quot;] - the user password.</li>
</ul>
            </td>
        </tr>
        
        <tr>
            <td>
                $response
            </td>
            <td>
                by reference
            </td>
            <td>
                array
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The response upon successful authentication. The expected properties are:</p>
<ul>
<li>$response[&quot;user_id&quot;] - id of the user.</li>
<li>$response[&quot;client_id&quot;] - id of the client (device token etc.).</li>
<li>$response[&quot;access_token&quot;] - access token generated upon successful authentication.</li>
<li>$response[&quot;access_token_expire&quot;] - expiration time of the access token.</li>
<li>$response[&quot;refresh_token&quot;] - refresh token generated upon successful authentication.</li>
<li>$response[&quot;refresh_token_expire&quot;] - expiration time of the refresh token.</li>
<li>$response[&quot;last_activity&quot;] - last activity time of the user of this token.</li>
<li>$response[&quot;jwt_access_token&quot;] - jwt access token generated upon successful authentication. JWT access
token is the access token encoded and signed by the JWT standard approach.
token is the access token encoded and signed by the JWT standard approach.</li>
</ul>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the private key is invalid.</li>
<li>if ssl signing fails due to system errors.</li>
<li>if the token storage fails to save the token record.</li>
</ul></div>
  
  
  <a href='class-OAuth2.InvalidCredentialsException.html'>\OAuth2\InvalidCredentialsException</a><br>
  
  <div class="item_description"><p>It might throw the InvalidCredentialsException if the authentication fails.</p></div>
  
  
  <a href='class-OAuth2.AuthSystemException.html'>\OAuth2\AuthSystemException</a><br>
  
  <div class="item_description"><p>It might throw the AuthSystemException if some system error occurs.</p></div>
  
  
  <a href='class-OAuth2.MissingParametersException.html'>\OAuth2\MissingParametersException</a><br>
  
  <div class="item_description"><p>It might throw the MissingParametersException if any required paramters are empty.</p></div>
  
  
  </div>

  
  <h2>Overrides</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.IOAuthManager.html#authenticateUser'>\OAuth2\Interfaces\IOAuthManager::authenticateUser()</a>
  </div>
  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#750'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#createTokenRecord'>\OAuth2\OAuthManager::createTokenRecord()</a><br>
  
  
  </div>

  

  

  

  

  <hr id="createJwtToken">
  
  <h1>Method: OAuthManager::createJwtToken()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> createJwtToken(<span class="php-keyword1">array</span> <span class="php-var">$payload</span>) : string;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for creation of the jwt token.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $payload
            </td>
            <td>
                by value
            </td>
            <td>
                array
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The payload array.
The payload array.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  string<br>
  
  <div class="item_description"><p>Returns the jwt token string.
Returns the jwt token string.</p></div>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the private key is invalid.</li>
<li>if ssl signing fails due to system errors.</li>
</ul></div>
  
  
  </div>

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#419'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  

  

  

  

  

  <hr id="createTokenRecord">
  
  <h1>Method: OAuthManager::createTokenRecord()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> createTokenRecord(string <span class="php-var">$user_id</span>, string <span class="php-var">$client_id</span>, <span class="php-keyword1">array</span> &amp;<span class="php-var">$response</span>) : void;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for creation of the token record.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $user_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The user id for which the tokens were issued.
The user id for which the tokens were issued.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $client_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The client id for which the tokens were issued.
The client id for which the tokens were issued.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $response
            </td>
            <td>
                by reference
            </td>
            <td>
                array
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The response to be filled with the user data and tokens.
The response to be filled with the user data and tokens.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the private key is invalid.</li>
<li>if ssl signing fails due to system errors.</li>
<li>if the token storage fails to save the token record.</li>
</ul></div>
  
  
  </div>

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#603'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='interface-OAuth2.Interfaces.ITokenStorage.html#saveTokenRecord'>\OAuth2\Interfaces\ITokenStorage::saveTokenRecord()</a><br>
  
  
  </div>

  <h2>Used by</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#authenticateUser'>\OAuth2\OAuthManager::authenticateUser()</a><br>
  
  
  <a href='class-OAuth2.OAuthManager.html#refreshTokens'>\OAuth2\OAuthManager::refreshTokens()</a><br>
  
  
  </div>

  

  

  

  <hr id="generateJwtSignature">
  
  <h1>Method: OAuthManager::generateJwtSignature()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> generateJwtSignature(string <span class="php-var">$input</span>) : string;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for generation of the signature of the data for all supported algorithms.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $input
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>Data to be signed.
Data to be signed.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  string<br>
  
  <div class="item_description"><p>Returns the signature of the data.
Returns the signature of the data.</p></div>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the private key is invalid.</li>
<li>if ssl signing fails due to system errors.</li>
</ul></div>
  
  
  </div>

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#284'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#generateRSASignature'>\OAuth2\OAuthManager::generateRSASignature()</a><br>
  
  
  </div>

  

  

  

  

  <hr id="generateRSASignature">
  
  <h1>Method: OAuthManager::generateRSASignature()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> generateRSASignature(string <span class="php-var">$input</span>, string <span class="php-var">$algorithm_id</span>) : string;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for generation of the signature of the data for the algorithms
RS256, RS384, RS512.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $input
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>Data which is signed.
Data which is signed.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $algorithm_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>Algorithm to use for signing. The supported algorithms are: RS256, RS384, RS512.
Algorithm to use for signing. The supported algorithms are: RS256, RS384, RS512.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  string<br>
  
  <div class="item_description"><p>Returns the signature of the data.
Returns the signature of the data.</p></div>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the private key is invalid.</li>
<li>if ssl signing fails due to system errors.</li>
</ul></div>
  
  
  </div>

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#244'>OAuth2/OAuthManager.php</a>
  </div>
  

  <h2>See also</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#verifyRSASignature'>\OAuth2\OAuthManager::verifyRSASignature()</a><br>
  
  
  </div>

  

  

  <h2>Used by</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#verifyRSASignature'>\OAuth2\OAuthManager::verifyRSASignature()</a><br>
  
  
  <a href='class-OAuth2.OAuthManager.html#generateJwtSignature'>\OAuth2\OAuthManager::generateJwtSignature()</a><br>
  
  
  </div>

  

  

  

  <hr id="generateToken">
  
  <h1>Method: OAuthManager::generateToken()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> generateToken() : string;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for generation of a token string.</p>
  </div>
  

  

  

  

  
  <h2>Returns</h2>
  <div class="item_list">
  string<br>
  
  <div class="item_description"><p>Returns the token string.
Returns the token string.</p></div>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if ssl funtions fail due to system errors.</li>
</ul></div>
  
  
  </div>

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#376'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  

  

  

  

  

  <hr id="getJwtPayload">
  
  <h1>Method: OAuthManager::getJwtPayload()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> getJwtPayload(string <span class="php-var">$jwt_access_token</span>, bool <span class="php-var">$verify_signature</span> = <span class="php-keyword1">true</span>) : <span class="php-keyword1">array</span>;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for extraction of the payload from the jwt access token.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $jwt_access_token
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The jwt access token.
The jwt access token.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $verify_signature
            </td>
            <td>
                by value
            </td>
            <td>
                bool
            </td>
            <td>
                true
            </td>
            <td class="description_column">
                <p>The flag to control whether the signature should be verified or not.
The flag to control whether the signature should be verified or not.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  array<br>
  
  <div class="item_description"><p>Returns the extracted payload array.
Returns the extracted payload array.</p></div>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the public key is invalid.</li>
<li>if the ssl verification cannot be performed due to system errors.</li>
</ul></div>
  
  
  <a href='class-OAuth2.InvalidTokenException.html'>\OAuth2\InvalidTokenException</a><br>
  
  <div class="item_description"><p>It might throw the InvalidTokenException if the jwt access token is invalid.</p></div>
  
  
  </div>

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#459'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  

  

  

  

  

  <hr id="init">
  
  <h1>Method: OAuthManager::init()</h1>

  <div class="definition"><span class="php-keyword1">public</span> <span class="php-keyword1">function</span> init(<span class="php-keyword1">array</span> <span class="php-var">$parameters</span>) : void;</div>

  
  <div class="short-description">
  <p>Initializes the authentication manager with parameters.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $parameters
            </td>
            <td>
                by value
            </td>
            <td>
                array
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The parameters are:</p>
<ul>
<li>
<p>$parameters[&quot;access_token_ttl_minutes&quot;] - time to live in minutes for the access token.</p>
</li>
<li>
<p>$parameters[&quot;refresh_token_ttl_days&quot;] - time to live in days for the refresh token.</p>
</li>
<li>
<p>$parameters[&quot;encryption_algorithm&quot;] - the encryption algorithm used for signing. The following
algorithms are supported: HS256, HS384, HS512, RS256, RS384, RS512.</p>
</li>
<li>
<p>$parameters[&quot;public_key&quot;] - location of the public key file. Required for the algorithms: RS256, RS384, RS512.</p>
</li>
<li>
<p>$parameters[&quot;private_key&quot;] - location of the private key file. Required for the algorithms: RS256, RS384, RS512.</p>
</li>
<li>
<p>$parameters[&quot;pass_phrase&quot;] - the pass phrase for the private key if necessary.</p>
</li>
<li>
<p>$parameters[&quot;token_storage&quot;] - the object implementing the interface <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>. It is used for storing and
validating of the stored tokens.</p>
</li>
<li>
<p>$parameters[&quot;user_authenticator&quot;] - the object implementing the interface <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>. It is used for authentication
of the user upon his credentials before generation of the tokens.
of the user upon his credentials before generation of the tokens.</p>
</li>
</ul>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
</ul></div>
  
  
  </div>

  
  <h2>Overrides</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.IOAuthManager.html#init'>\OAuth2\Interfaces\IOAuthManager::init()</a>
  </div>
  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#660'>OAuth2/OAuthManager.php</a>
  </div>
  

  <h2>See also</h2>
  <div class="item_list">
  
  <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a><br>
  
  
  <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a><br>
  
  
  </div>

  

  

  

  

  

  

  <hr id="invalidateClient">
  
  <h1>Method: OAuthManager::invalidateClient()</h1>

  <div class="definition"><span class="php-keyword1">public</span> <span class="php-keyword1">function</span> invalidateClient(string <span class="php-var">$user_id</span>, string <span class="php-var">$client_id</span>, string <span class="php-var">$refresh_token</span>) : void;</div>

  
  <div class="short-description">
  <p>Invalidates all token records for the client.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>The invalidation by the client id is asserted by a valid client id and
a valid refresh token. If the refresh token is expired, the invalidation
can be done only after authentication.</p>
<p>The invalidation is done by using <a href='interface-OAuth2.Interfaces.ITokenStorage.html#deleteTokenRecordByKey'>\OAuth2\Interfaces\ITokenStorage::deleteTokenRecordByKey()</a> with the key 'client_id'.</p>
  </div>
  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $user_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The user id for which the refresh token was issued.
The user id for which the refresh token was issued.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $client_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The client id for which the refresh token was issued.
The client id for which the refresh token was issued.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $refresh_token
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The refresh token generated upon successful authentication.
The refresh token generated upon successful authentication.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if the token storage fails to verify the token record.</li>
<li>if the token storage fails to delete the token record.</li>
</ul></div>
  
  
  <a href='class-OAuth2.InvalidTokenException.html'>\OAuth2\InvalidTokenException</a><br>
  
  <div class="item_description"><p>It might throw the InvalidTokenException if the refresh token is invalid or expired.</p></div>
  
  
  <a href='class-OAuth2.TokenExpiredException.html'>\OAuth2\TokenExpiredException</a><br>
  
  <div class="item_description"><p>It might throw the TokenExpiredException if the jwt refresh token is expired.</p></div>
  
  
  <a href='class-OAuth2.AuthSystemException.html'>\OAuth2\AuthSystemException</a><br>
  
  <div class="item_description"><p>It might throw the AuthSystemException if some system error occurs.</p></div>
  
  
  <a href='class-OAuth2.MissingParametersException.html'>\OAuth2\MissingParametersException</a><br>
  
  <div class="item_description"><p>It might throw the MissingParametersException if any required paramters are empty.</p></div>
  
  
  </div>

  
  <h2>Overrides</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.IOAuthManager.html#invalidateClient'>\OAuth2\Interfaces\IOAuthManager::invalidateClient()</a>
  </div>
  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#1058'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#verifyRefreshToken'>\OAuth2\OAuthManager::verifyRefreshToken()</a><br>
  
  
  <a href='interface-OAuth2.Interfaces.ITokenStorage.html#deleteTokenRecordByKey'>\OAuth2\Interfaces\ITokenStorage::deleteTokenRecordByKey()</a><br>
  
  
  </div>

  

  

  

  

  <hr id="invalidateJwtAccessToken">
  
  <h1>Method: OAuthManager::invalidateJwtAccessToken()</h1>

  <div class="definition"><span class="php-keyword1">public</span> <span class="php-keyword1">function</span> invalidateJwtAccessToken(string <span class="php-var">$jwt_access_token</span>) : void;</div>

  
  <div class="short-description">
  <p>Invalidates the token record for the jwt access token.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>The invalidation is done by using <a href='interface-OAuth2.Interfaces.ITokenStorage.html#deleteTokenRecordByKey'>\OAuth2\Interfaces\ITokenStorage::deleteTokenRecordByKey()</a> with the key 'access_token'.</p>
<p>The origin access token is extracted from the jwt payload.</p>
  </div>
  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $jwt_access_token
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The jwt access token generated upon successful authentication.
The jwt access token generated upon successful authentication.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the public key is invalid.</li>
<li>if the ssl verification cannot be performed due to system errors.</li>
<li>if the token storage fails to delete the token record.</li>
</ul></div>
  
  
  <a href='class-OAuth2.InvalidTokenException.html'>\OAuth2\InvalidTokenException</a><br>
  
  <div class="item_description"><p>It might throw the InvalidTokenException if the jwt access token is invalid.</p></div>
  
  
  </div>

  
  <h2>Overrides</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.IOAuthManager.html#invalidateJwtAccessToken'>\OAuth2\Interfaces\IOAuthManager::invalidateJwtAccessToken()</a>
  </div>
  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#1107'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='interface-OAuth2.Interfaces.ITokenStorage.html#deleteTokenRecordByKey'>\OAuth2\Interfaces\ITokenStorage::deleteTokenRecordByKey()</a><br>
  
  
  </div>

  

  

  

  

  <hr id="invalidateRefreshToken">
  
  <h1>Method: OAuthManager::invalidateRefreshToken()</h1>

  <div class="definition"><span class="php-keyword1">public</span> <span class="php-keyword1">function</span> invalidateRefreshToken(string <span class="php-var">$refresh_token</span>) : void;</div>

  
  <div class="short-description">
  <p>Invalidates all token records for the refresh token.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>The invalidation is done by using <a href='interface-OAuth2.Interfaces.ITokenStorage.html#deleteTokenRecordByKey'>\OAuth2\Interfaces\ITokenStorage::deleteTokenRecordByKey()</a> with the key 'refresh_token'.</p>
  </div>
  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $refresh_token
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The refresh token generated upon successful authentication.
The refresh token generated upon successful authentication.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if the token storage fails to delete the token record.</li>
</ul></div>
  
  
  <a href='class-OAuth2.InvalidTokenException.html'>\OAuth2\InvalidTokenException</a><br>
  
  <div class="item_description"><p>It should throw the InvalidTokenException if the refresh token is invalid.</p></div>
  
  
  </div>

  
  <h2>Overrides</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.IOAuthManager.html#invalidateRefreshToken'>\OAuth2\Interfaces\IOAuthManager::invalidateRefreshToken()</a>
  </div>
  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#1144'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='interface-OAuth2.Interfaces.ITokenStorage.html#deleteTokenRecordByKey'>\OAuth2\Interfaces\ITokenStorage::deleteTokenRecordByKey()</a><br>
  
  
  </div>

  

  

  

  

  <hr id="invalidateUser">
  
  <h1>Method: OAuthManager::invalidateUser()</h1>

  <div class="definition"><span class="php-keyword1">public</span> <span class="php-keyword1">function</span> invalidateUser(string <span class="php-var">$user_id</span>, string <span class="php-var">$client_id</span>, string <span class="php-var">$refresh_token</span>) : void;</div>

  
  <div class="short-description">
  <p>Invalidates all token records for the user.</p>
  </div>
  

  
  <div class="long_description">
  <h2>Details</h2>
  <p>The invalidation by the user id is asserted by a valid client id and
a valid refresh token. If the refresh token is expired, the invalidation
can be done only after authentication.</p>
<p>The invalidation is done by using <a href='interface-OAuth2.Interfaces.ITokenStorage.html#deleteTokenRecordByKey'>\OAuth2\Interfaces\ITokenStorage::deleteTokenRecordByKey()</a> with the key 'user_id'.</p>
  </div>
  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $user_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The user id for which the refresh token was issued.
The user id for which the refresh token was issued.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $client_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The client id for which the refresh token was issued.
The client id for which the refresh token was issued.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $refresh_token
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The refresh token generated upon successful authentication.
The refresh token generated upon successful authentication.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if the token storage fails to verify the token record.</li>
<li>if the token storage fails to delete the token record.</li>
</ul></div>
  
  
  <a href='class-OAuth2.InvalidTokenException.html'>\OAuth2\InvalidTokenException</a><br>
  
  <div class="item_description"><p>It might throw the InvalidTokenException if the refresh token is invalid or expired.</p></div>
  
  
  <a href='class-OAuth2.TokenExpiredException.html'>\OAuth2\TokenExpiredException</a><br>
  
  <div class="item_description"><p>It might throw the TokenExpiredException if the jwt refresh token is expired.</p></div>
  
  
  <a href='class-OAuth2.AuthSystemException.html'>\OAuth2\AuthSystemException</a><br>
  
  <div class="item_description"><p>It might throw the AuthSystemException if some system error occurs.</p></div>
  
  
  <a href='class-OAuth2.MissingParametersException.html'>\OAuth2\MissingParametersException</a><br>
  
  <div class="item_description"><p>It might throw the MissingParametersException if any required paramters are empty.</p></div>
  
  
  </div>

  
  <h2>Overrides</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.IOAuthManager.html#invalidateUser'>\OAuth2\Interfaces\IOAuthManager::invalidateUser()</a>
  </div>
  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#996'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#verifyRefreshToken'>\OAuth2\OAuthManager::verifyRefreshToken()</a><br>
  
  
  <a href='interface-OAuth2.Interfaces.ITokenStorage.html#deleteTokenRecordByKey'>\OAuth2\Interfaces\ITokenStorage::deleteTokenRecordByKey()</a><br>
  
  
  </div>

  

  

  

  

  <hr id="refreshTokens">
  
  <h1>Method: OAuthManager::refreshTokens()</h1>

  <div class="definition"><span class="php-keyword1">public</span> <span class="php-keyword1">function</span> refreshTokens(string <span class="php-var">$refresh_token</span>, string <span class="php-var">$user_id</span>, string <span class="php-var">$client_id</span>, <span class="php-keyword1">array</span> &amp;<span class="php-var">$response</span>) : void;</div>

  
  <div class="short-description">
  <p>Refreshes the access and refresh tokens by using the valid refresh token.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $refresh_token
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The refresh token generated upon successful authentication.
The refresh token generated upon successful authentication.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $user_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The user id for which the refresh token was issued.
The user id for which the refresh token was issued.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $client_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The client id for which the refresh token was issued.
The client id for which the refresh token was issued.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $response
            </td>
            <td>
                by reference
            </td>
            <td>
                array
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The response upon successful refresh. The expected properties are:</p>
<ul>
<li>$response[&quot;user_id&quot;] - id of the user.</li>
<li>$response[&quot;client_id&quot;] - id of the client (device token etc.).</li>
<li>$response[&quot;access_token&quot;] - access token generated upon successful authentication.</li>
<li>$response[&quot;access_token_expire&quot;] - expiration time of the access token.</li>
<li>$response[&quot;refresh_token&quot;] - refresh token generated upon successful authentication.</li>
<li>$response[&quot;refresh_token_expire&quot;] - expiration time of the refresh token.</li>
<li>$response[&quot;last_activity&quot;] - last activity time of the user of this token.</li>
<li>$response[&quot;jwt_access_token&quot;] - jwt access token generated upon successful authentication. JWT access
token is the access token encoded and signed by the JWT standard approach.
token is the access token encoded and signed by the JWT standard approach.</li>
</ul>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the private key is invalid.</li>
<li>if ssl signing fails due to system errors.</li>
<li>if the token storage fails to verify the token record.</li>
<li>if the token storage fails to save the token record.</li>
</ul></div>
  
  
  <a href='class-OAuth2.InvalidTokenException.html'>\OAuth2\InvalidTokenException</a><br>
  
  <div class="item_description"><p>It might throw the InvalidTokenException if the refresh token is invalid or expired.</p></div>
  
  
  <a href='class-OAuth2.TokenExpiredException.html'>\OAuth2\TokenExpiredException</a><br>
  
  <div class="item_description"><p>It might throw the TokenExpiredException if the refresh token is expired.</p></div>
  
  
  <a href='class-OAuth2.AuthSystemException.html'>\OAuth2\AuthSystemException</a><br>
  
  <div class="item_description"><p>It might throw the AuthSystemException if some system error occurs.</p></div>
  
  
  <a href='class-OAuth2.MissingParametersException.html'>\OAuth2\MissingParametersException</a><br>
  
  <div class="item_description"><p>It might throw the MissingParametersException if any required paramters are empty.</p></div>
  
  
  </div>

  
  <h2>Overrides</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.IOAuthManager.html#refreshTokens'>\OAuth2\Interfaces\IOAuthManager::refreshTokens()</a>
  </div>
  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#815'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#createTokenRecord'>\OAuth2\OAuthManager::createTokenRecord()</a><br>
  
  
  <a href='class-OAuth2.OAuthManager.html#verifyRefreshToken'>\OAuth2\OAuthManager::verifyRefreshToken()</a><br>
  
  
  </div>

  

  

  

  

  <hr id="urlSafeB64Decode">
  
  <h1>Method: OAuthManager::urlSafeB64Decode()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> urlSafeB64Decode(string <span class="php-var">$b64</span>) : string;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for safe base64 decoding.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $b64
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>Data to be decoded.
Data to be decoded.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  string<br>
  
  <div class="item_description"><p>Returns the base64 decoded data string.
Returns the base64 decoded data string.</p></div>
  
  </div>
  

  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#161'>OAuth2/OAuthManager.php</a>
  </div>
  

  <h2>See also</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#urlSafeB64Encode'>\OAuth2\OAuthManager::urlSafeB64Encode()</a><br>
  
  
  </div>

  

  

  

  

  

  

  <hr id="urlSafeB64Encode">
  
  <h1>Method: OAuthManager::urlSafeB64Encode()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> urlSafeB64Encode(string <span class="php-var">$data</span>) : string;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for safe base64 encoding.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $data
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>Data to be encoded.
Data to be encoded.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  string<br>
  
  <div class="item_description"><p>Returns the base64 encoded data string.
Returns the base64 encoded data string.</p></div>
  
  </div>
  

  

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#140'>OAuth2/OAuthManager.php</a>
  </div>
  

  <h2>See also</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#urlSafeB64Decode'>\OAuth2\OAuthManager::urlSafeB64Decode()</a><br>
  
  
  </div>

  

  

  

  

  

  

  <hr id="validateParameters">
  
  <h1>Method: OAuthManager::validateParameters()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> validateParameters() : void;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for validation of the parameters.</p>
  </div>
  

  

  

  

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
</ul></div>
  
  
  </div>

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#519'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  

  

  

  

  

  <hr id="verifyJwtAccessToken">
  
  <h1>Method: OAuthManager::verifyJwtAccessToken()</h1>

  <div class="definition"><span class="php-keyword1">public</span> <span class="php-keyword1">function</span> verifyJwtAccessToken(string <span class="php-var">$jwt_access_token</span>, bool <span class="php-var">$check_on_server</span> = <span class="php-keyword1">true</span>) : <span class="php-keyword1">array</span>|<span class="php-keyword1">false</span>;</div>

  
  <div class="short-description">
  <p>Verifies the jwt access token.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $jwt_access_token
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The jwt access token generated upon successful authentication.
The jwt access token generated upon successful authentication.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $check_on_server
            </td>
            <td>
                by value
            </td>
            <td>
                bool
            </td>
            <td>
                true
            </td>
            <td class="description_column">
                <p>This flag defines whether only the signatire should be checked or also the
authentication server should be asked.
authentication server should be asked.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  array|false<br>
  
  <div class="item_description"><p>Returns the payload array on successful verification, otherwise false.
Returns the payload array on successful verification, otherwise false.</p></div>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the public key is invalid.</li>
<li>if the ssl verification cannot be performed due to system errors.</li>
<li>if the token storage fails to verify the token record.</li>
</ul></div>
  
  
  <a href='class-OAuth2.InvalidTokenException.html'>\OAuth2\InvalidTokenException</a><br>
  
  <div class="item_description"><p>It might throw the InvalidTokenException if the jwt access token is invalid.</p></div>
  
  
  <a href='class-OAuth2.TokenExpiredException.html'>\OAuth2\TokenExpiredException</a><br>
  
  <div class="item_description"><p>It might throw the TokenExpiredException if the jwt access token is expired.</p></div>
  
  
  <a href='class-OAuth2.AuthSystemException.html'>\OAuth2\AuthSystemException</a><br>
  
  <div class="item_description"><p>It might throw the AuthSystemException if some system error occurs.</p></div>
  
  
  <a href='class-OAuth2.MissingParametersException.html'>\OAuth2\MissingParametersException</a><br>
  
  <div class="item_description"><p>It might throw the MissingParametersException if any required paramters are empty.</p></div>
  
  
  </div>

  
  <h2>Overrides</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.IOAuthManager.html#verifyJwtAccessToken'>\OAuth2\Interfaces\IOAuthManager::verifyJwtAccessToken()</a>
  </div>
  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#862'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='interface-OAuth2.Interfaces.ITokenStorage.html#loadTokenRecord'>\OAuth2\Interfaces\ITokenStorage::loadTokenRecord()</a><br>
  
  
  </div>

  

  

  

  

  <hr id="verifyJwtSignature">
  
  <h1>Method: OAuthManager::verifyJwtSignature()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> verifyJwtSignature(string <span class="php-var">$input</span>, string <span class="php-var">$signature</span>) : void;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for verification of the signature of the data for all supported algorithms.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $input
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>Data which was signed.
Data which was signed.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $signature
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>Signature used for signing.
Signature used for signing.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the public key is invalid.</li>
<li>if the ssl verification cannot be performed due to system errors.</li>
</ul></div>
  
  
  </div>

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#335'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#verifyRSASignature'>\OAuth2\OAuthManager::verifyRSASignature()</a><br>
  
  
  </div>

  

  

  

  

  <hr id="verifyRSASignature">
  
  <h1>Method: OAuthManager::verifyRSASignature()</h1>

  <div class="definition"><span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> verifyRSASignature(string <span class="php-var">$input</span>, string <span class="php-var">$signature</span>, string <span class="php-var">$algorithm_id</span>) : void;</div>

  
  <div class="short-description">
  <p>Internal auxiliary function for verification of the data signature for the algorithms
RS256, RS384, RS512.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $input
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>Data which is signed.
Data which is signed.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $signature
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>Signature used for signing the data.
Signature used for signing the data.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $algorithm_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>Algorithm used for signing. The supported algorithms are: RS256, RS384, RS512.
Algorithm used for signing. The supported algorithms are: RS256, RS384, RS512.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors:</p>
<ul>
<li>if any required initialization parameters are empty.</li>
<li>if any initialization parameters are invalid.</li>
<li>if token_storage does not implement <a href='interface-OAuth2.Interfaces.ITokenStorage.html'>\OAuth2\Interfaces\ITokenStorage</a>.</li>
<li>if user_authenticator does not implement <a href='interface-OAuth2.Interfaces.IUserAuthenticator.html'>\OAuth2\Interfaces\IUserAuthenticator</a>.</li>
<li>if the public key is invalid.</li>
<li>if the ssl verification cannot be performed due to system errors.</li>
</ul></div>
  
  
  </div>

  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#197'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#generateRSASignature'>\OAuth2\OAuthManager::generateRSASignature()</a><br>
  
  
  </div>

  <h2>Used by</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#verifyJwtSignature'>\OAuth2\OAuthManager::verifyJwtSignature()</a><br>
  
  
  </div>

  

  

  

  <hr id="verifyRefreshToken">
  
  <h1>Method: OAuthManager::verifyRefreshToken()</h1>

  <div class="definition"><span class="php-keyword1">public</span> <span class="php-keyword1">function</span> verifyRefreshToken(string <span class="php-var">$refresh_token</span>, string <span class="php-var">$user_id</span>, string <span class="php-var">$client_id</span>) : void;</div>

  
  <div class="short-description">
  <p>Verifies the refresh token.</p>
  </div>
  

  

  

  <h2>Parameters</h2>

    <table class="table table-responsive table-bordered table-striped param_multicolumn">
        <tr>
        <th>Name</th>
        <th>Pass type</th>
        <th>Value type</th>
        <th>Default value</th>
        <th>Description</th>
        </tr>
        
        
        <tr>
            <td>
                $refresh_token
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The refresh token to be verified.
The refresh token to be verified.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $user_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The user id for which the refresh token was issued.
The user id for which the refresh token was issued.</p>
            </td>
        </tr>
        
        <tr>
            <td>
                $client_id
            </td>
            <td>
                by value
            </td>
            <td>
                string
            </td>
            <td>
                
            </td>
            <td class="description_column">
                <p>The client id for which the refresh token was issued.
The client id for which the refresh token was issued.</p>
            </td>
        </tr>
        
        
    </table>

  
  <h2>Returns</h2>
  <div class="item_list">
  void<br>
  
  </div>
  

  <h2>Throws</h2>
  <div class="item_list">
  
  \Exception<br>
  
  <div class="item_description"><p>It might throw an exception in the case of any system errors.</p></div>
  
  
  <a href='class-OAuth2.InvalidTokenException.html'>\OAuth2\InvalidTokenException</a><br>
  
  <div class="item_description"><p>It should throw the InvalidTokenException if the refresh token is invalid.</p></div>
  
  
  <a href='class-OAuth2.TokenExpiredException.html'>\OAuth2\TokenExpiredException</a><br>
  
  <div class="item_description"><p>It might throw the TokenExpiredException if the jwt access token is expired.</p></div>
  
  
  <a href='class-OAuth2.AuthSystemException.html'>\OAuth2\AuthSystemException</a><br>
  
  <div class="item_description"><p>It might throw the AuthSystemException if some system error occurs.</p></div>
  
  
  <a href='class-OAuth2.MissingParametersException.html'>\OAuth2\MissingParametersException</a><br>
  
  <div class="item_description"><p>It should throw the MissingParametersException if any required parameters are empty.</p></div>
  
  
  </div>

  
  <h2>Overrides</h2>
  <div class="item_list">
  <a href='interface-OAuth2.Interfaces.IOAuthManager.html#verifyRefreshToken'>\OAuth2\Interfaces\IOAuthManager::verifyRefreshToken()</a>
  </div>
  

  <h2>Authors</h2>
  <div class="item_list">
  
  <div class='item'>Oleg Schildt</div>
  
  </div>

  

  

  
  <h2>Source code</h2>
  <div class="item_list">
  <a href='source-OAuth2.OAuthManager.php.html#936'>OAuth2/OAuthManager.php</a>
  </div>
  

  

  

  <h2>Uses</h2>
  <div class="item_list">
  
  <a href='interface-OAuth2.Interfaces.ITokenStorage.html#loadTokenRecord'>\OAuth2\Interfaces\ITokenStorage::loadTokenRecord()</a><br>
  
  
  </div>

  <h2>Used by</h2>
  <div class="item_list">
  
  <a href='class-OAuth2.OAuthManager.html#refreshTokens'>\OAuth2\OAuthManager::refreshTokens()</a><br>
  
  
  <a href='class-OAuth2.OAuthManager.html#invalidateUser'>\OAuth2\OAuthManager::invalidateUser()</a><br>
  
  
  <a href='class-OAuth2.OAuthManager.html#invalidateClient'>\OAuth2\OAuthManager::invalidateClient()</a><br>
  
  
  </div>
                    
                    <div id="footer">
                        Generated on 2025-03-26 06:57 with <a href="https://github.com/oschildt/PhpDoxy" target="_blank">PhpDoxy</a>
                    </div>                    
                </div>
            </div>
        </div>

        <script src="resources/jquery-3.2.1.min.js"></script>
        <script src="resources/jquery-ui-1.12.1.min.js"></script>

        <script src="elementlist.js"></script>
        <script src="resources/main.js"></script>
        
        <script src="resources/jquery.iviewer.js" type="text/javascript"></script>
        <script src="resources/jquery.mousewheel.js" type="text/javascript"></script>
        
    </body>
</html>


